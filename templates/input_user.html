{% extends "layout.html" %} {% block title %}Új Felhasználó - Jogügyleti
Nyilvántartó{% endblock %} {% block content %}
<h1 class="text-center mb-5">Új Felhasználó Felvétele</h1>

<div class="row g-4 justify-content-center">
  <div class="card shadow-sm col-md-6">
    <div class="card-body">
      <h5 class="card-title mb-3">Felhasználó adatai</h5>

      {% if message %}
      <div class="alert alert-success">{{ message }}</div>
      {% endif %} {% if error %}
      <div class="alert alert-danger">{{ error }}</div>
      {% endif %}
      <form method="post">
        <div class="mb-3">
          <label class="form-label">Vezetéknév</label>
          <input
            class="form-control"
            name="last_name"
            id="last_name"
            required
          />
        </div>

        <div class="mb-3">
          <label class="form-label">Keresztnév</label>
          <input
            class="form-control"
            name="first_name"
            id="first_name"
            required
          />
        </div>

        <div class="mb-3">
          <label class="form-label">Felhasználónév</label>
          <input class="form-control" name="username" id="username" required />
        </div>

        <div class="d-flex gap-2">
          <button type="submit" class="btn btn-primary flex-fill">
            Mentés
          </button>
          <button type="reset" class="btn btn-outline-secondary flex-fill">
            Törlés
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %} {% block extra_js %}
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const firstNameInput = document.getElementById('first_name');
    const lastNameInput = document.getElementById('last_name');
    const usernameInput = document.getElementById('username');

    function generateUsername() {
      const firstName = firstNameInput.value.trim();
      const lastName = lastNameInput.value.trim();

      if (firstName || lastName) {
        // Convert to lowercase
        // Replace spaces or multiple spaces with underscore
        const username = `${firstName} ${lastName}`
          .toLowerCase()
          .normalize('NFD') // decompose accents
          .replace(/[\u0300-\u036f]/g, '') // remove diacritics
          .replace(/\s+/g, '_'); // replace spaces with underscores

        usernameInput.value = username;
      } else {
        usernameInput.value = '';
      }
    }

    // Listen to both inputs
    firstNameInput.addEventListener('input', generateUsername);
    lastNameInput.addEventListener('input', generateUsername);
  });
</script>
{% endblock %}
